import{_ as E}from"./BkTrhf9-.js";import{l as N,m as S,L as J,G as r,N as C,E as n,H as e,M as y,Q as V,U as p,d as w,O as v,T as B,a0 as M,q as _,I as Q,J as K,ac as X,W as Y}from"./DQgDrh1u.js";import{_ as T}from"./DlAUqK2U.js";import{P as x,a as Z,b as ee,f as te,d as oe,n as se}from"./Cm96zG12.js";import{s as le}from"./x_rD_Ya3.js";import"./DAvq3nrc.js";const re=["d"],ne={class:"flex-1 sidebar-label"},ae=["aria-label"],ie=N({__name:"SidebarLink",props:{to:{},icon:{},label:{},isActive:{type:Boolean},badge:{}},emits:["click"],setup(P,{emit:d}){const m=P,h=d,i=S(()=>{const u="relative cursor-pointer";return m.isActive?`${u} bg-blue-50 text-blue-700 shadow-sm border border-blue-100`:`${u} text-gray-600 hover:bg-gray-50 hover:text-gray-900`}),c=S(()=>m.isActive?"text-blue-600":"text-gray-400 group-hover:text-gray-600"),f=u=>{console.log("🔗 [SidebarLink] Click détecté pour:",m.label,{to:m.to,isActive:m.isActive,target:u.target});try{h("click",u),console.log("✅ [SidebarLink] Événement click émis pour:",m.label)}catch(g){console.error("❌ [SidebarLink] Erreur lors de l'émission du click:",g)}};return(u,g)=>{const k=E;return r(),J(k,{to:u.to,class:V(["group flex items-center rounded-xl px-4 py-3 text-sm font-medium transition-all duration-200 sidebar-link",i.value]),onClick:f,tabindex:0,"aria-current":u.isActive?"page":void 0},{default:C(()=>[(r(),n("svg",{class:V(["mr-3 h-5 w-5 transition-colors duration-200 sidebar-icon",c.value]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:u.icon},null,8,re)],2)),e("span",ne,p(u.label),1),u.badge?(r(),n("span",{key:0,class:"ml-auto inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-500 rounded-full min-w-[20px] h-5 sidebar-badge","aria-label":`${u.badge} notification${u.badge>1?"s":""}`},p(u.badge>99?"99+":u.badge),9,ae)):y("",!0)]),_:1},8,["to","class","aria-current"])}}}),ue=T(ie,[["__scopeId","data-v-465d3ab0"]]),de={class:"flex flex-col h-full bg-white"},ce={class:"flex h-16 items-center justify-between px-6 border-b border-gray-100"},pe={class:"flex-1 px-4 py-6 space-y-2 overflow-y-auto sidebar-navigation"},ve={class:"px-4 pb-4 border-t border-gray-100 pt-4"},fe=["disabled"],be={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},me={key:1,class:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ge=["disabled"],he={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},ye={key:1,class:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xe=["disabled"],ke={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},we={key:1,class:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ce={key:3,class:"w-full bg-gradient-to-r from-green-600 to-emerald-600 text-white font-semibold py-3 px-4 rounded-xl shadow-lg flex items-center justify-center space-x-2 mb-3"},Me=["disabled"],Le={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},Ae={key:1,class:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Se=["disabled"],$e={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},_e={key:1,class:"w-5 h-5 group-hover:scale-110 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={key:6,class:"text-center text-xs text-gray-500 bg-blue-50 border border-blue-200 rounded-lg py-2 px-3"},je={class:"flex items-center justify-center space-x-1"},ze={class:"font-medium text-blue-700"},Be={key:7,class:"text-center text-xs text-red-700 bg-red-50 border border-red-200 rounded-lg py-2 px-3"},Ie={class:"border-t border-gray-100 p-4 bg-white"},De={class:"relative",ref:"profileDropdown"},He={class:"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 shadow-md"},Ve={class:"text-sm font-semibold text-white"},Ee={class:"flex-1 min-w-0 text-left"},Ne={class:"text-sm font-semibold text-gray-900 truncate"},Te={class:"text-xs text-gray-500 truncate"},Ue={key:0,class:"absolute bottom-full left-0 right-0 mb-2 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50"},Re=N({__name:"SidebarContent",props:{unreadCount:{},userName:{},userEmail:{},userInitials:{},showProfileMenu:{type:Boolean},isMobile:{type:Boolean,default:!1},userSubscriptionPlan:{default:"free"},userSubscriptionActive:{type:Boolean,default:!1},trialDaysLeft:{default:0}},emits:["toggle-profile","close-profile","logout","close-mobile","upgrade-to-plan"],setup(P,{emit:d}){const m=P,h=d,i=w(null);S(()=>!1);const c=t=>{console.log("🖱️ [SidebarContent] Navigation click détecté",{isMobile:m.isMobile,target:t?.target}),t&&t.stopPropagation(),m.isMobile&&(console.log("📱 [SidebarContent] Fermeture du menu mobile"),setTimeout(()=>{h("close-mobile")},100)),m.showProfileMenu&&h("close-profile")},f=()=>{console.log("❌ [SidebarContent] Close mobile trigger"),h("close-mobile")},u=()=>{console.log("👤 [SidebarContent] Toggle profile menu"),h("toggle-profile")},g=()=>{console.log("❌ [SidebarContent] Close profile menu"),h("close-profile")},k=()=>{console.log("🚪 [SidebarContent] Logout trigger"),h("logout")},a=async t=>{console.log(`🚀 [SidebarContent] Upgrade click vers ${t}`),i.value=t;try{h("upgrade-to-plan",t),console.log(`✅ [SidebarContent] Événement upgrade émis pour ${t}`)}catch(o){console.error("❌ [SidebarContent] Erreur upgrade:",o),i.value=null}};return(t,o)=>{const b=ue,L=E;return r(),n("div",de,[e("div",ce,[o[6]||(o[6]=e("div",{class:"flex items-center space-x-3"},[e("div",{class:"flex h-9 w-9 items-center justify-center rounded-xl bg-gradient-to-br from-blue-600 to-blue-700 shadow-lg"},[e("span",{class:"text-sm font-bold text-white"},"CS")]),e("span",{class:"text-xl font-bold text-gray-900"},"ChatSeller")],-1)),t.isMobile?(r(),n("button",{key:0,onClick:f,class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors lg:hidden",type:"button"},o[5]||(o[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))):y("",!0)]),e("nav",pe,[v(b,{to:"/",isActive:(t._.provides[x]||t.$route).path==="/",icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2V7a2 2 0 012-2h2a2 2 0 002 2v2a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 00-2 2h-2a2 2 0 00-2 2v6a2 2 0 01-2 2H9z",label:"Dashboard",onClick:c},null,8,["isActive"]),v(b,{to:"/vendeurs-ia",isActive:(t._.provides[x]||t.$route).path.startsWith("/vendeurs-ia"),icon:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",label:"Vendeurs IA",onClick:c},null,8,["isActive"]),v(b,{to:"/conversations",isActive:(t._.provides[x]||t.$route).path.startsWith("/conversations"),icon:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",label:"Conversations",badge:t.unreadCount>0?t.unreadCount:null,onClick:c},null,8,["isActive","badge"]),v(b,{to:"/orders",isActive:(t._.provides[x]||t.$route).path.startsWith("/orders"),icon:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z",label:"Commandes",onClick:c},null,8,["isActive"]),v(b,{to:"/products",isActive:(t._.provides[x]||t.$route).path.startsWith("/products"),icon:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",label:"Produits",onClick:c},null,8,["isActive"]),v(b,{to:"/analytics",isActive:(t._.provides[x]||t.$route).path.startsWith("/analytics"),icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2-2V7a2 2 0 012-2h2a2 2 0 002 2v2a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 00-2 2h-2a2 2 0 00-2 2v6a2 2 0 01-2 2H9z",label:"Analytics",onClick:c},null,8,["isActive"]),v(b,{to:"/knowledge-base",isActive:(t._.provides[x]||t.$route).path.startsWith("/knowledge-base"),icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253",label:"Base de connaissance",onClick:c},null,8,["isActive"]),v(b,{to:"/billing",isActive:(t._.provides[x]||t.$route).path.startsWith("/billing"),icon:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z",label:"Facturation",onClick:c},null,8,["isActive"]),v(b,{to:"/settings",isActive:(t._.provides[x]||t.$route).path.startsWith("/settings"),icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z",label:"Paramètres",onClick:c},null,8,["isActive"])]),e("div",ve,[t.userSubscriptionPlan==="free"&&t.userSubscriptionActive&&t.trialDaysLeft>0?(r(),n("button",{key:0,onClick:o[0]||(o[0]=A=>a("starter")),disabled:i.value==="starter",type:"button",class:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed group mb-3"},[i.value==="starter"?(r(),n("svg",be,o[7]||(o[7]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),n("svg",me,o[8]||(o[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"},null,-1)]))),e("span",null,p(i.value==="starter"?"Redirection...":"Passer à Starter"),1)],8,fe)):t.userSubscriptionPlan==="free"&&(!t.userSubscriptionActive||t.trialDaysLeft===0)?(r(),n("button",{key:1,onClick:o[1]||(o[1]=A=>a("starter")),disabled:i.value==="starter",type:"button",class:"w-full bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed group mb-3"},[i.value==="starter"?(r(),n("svg",he,o[9]||(o[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),n("svg",ye,o[10]||(o[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),e("span",null,p(i.value==="starter"?"Redirection...":"Réactiver (Starter)"),1)],8,ge)):t.userSubscriptionPlan==="starter"&&t.userSubscriptionActive?(r(),n("button",{key:2,onClick:o[2]||(o[2]=A=>a("pro")),disabled:i.value==="pro",type:"button",class:"w-full bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed group mb-3"},[i.value==="pro"?(r(),n("svg",ke,o[11]||(o[11]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),n("svg",we,o[12]||(o[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"},null,-1)]))),e("span",null,p(i.value==="pro"?"Redirection...":"Passer au Pro"),1)],8,xe)):t.userSubscriptionPlan==="pro"&&t.userSubscriptionActive?(r(),n("div",Ce,o[13]||(o[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),e("span",null,"Plan Pro Actif",-1)]))):t.userSubscriptionPlan==="starter"&&!t.userSubscriptionActive?(r(),n("button",{key:4,onClick:o[3]||(o[3]=A=>a("starter")),disabled:i.value==="starter",type:"button",class:"w-full bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed group mb-3"},[i.value==="starter"?(r(),n("svg",Le,o[14]||(o[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),n("svg",Ae,o[15]||(o[15]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),e("span",null,p(i.value==="starter"?"Redirection...":"Réactiver Starter"),1)],8,Me)):t.userSubscriptionPlan==="pro"&&!t.userSubscriptionActive?(r(),n("button",{key:5,onClick:o[4]||(o[4]=A=>a("pro")),disabled:i.value==="pro",type:"button",class:"w-full bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-semibold py-3 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed group mb-3"},[i.value==="pro"?(r(),n("svg",$e,o[16]||(o[16]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(r(),n("svg",_e,o[17]||(o[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))),e("span",null,p(i.value==="pro"?"Redirection...":"Réactiver Pro"),1)],8,Se)):y("",!0),t.userSubscriptionPlan==="free"&&t.userSubscriptionActive&&t.trialDaysLeft>0?(r(),n("div",Pe,[e("div",je,[o[18]||(o[18]=e("svg",{class:"w-3 h-3 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",ze,p(t.trialDaysLeft)+" jour(s) d'essai",1)])])):t.userSubscriptionPlan==="free"&&(!t.userSubscriptionActive||t.trialDaysLeft===0)?(r(),n("div",Be,o[19]||(o[19]=[e("div",{class:"flex items-center justify-center space-x-1"},[e("svg",{class:"w-3 h-3 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"font-medium"},"Essai expiré")],-1)]))):y("",!0)]),e("div",Ie,[e("div",De,[e("button",{onClick:u,type:"button",class:"w-full flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 transition-all duration-200 group focus:outline-none focus:ring-2 focus:ring-blue-500"},[e("div",He,[e("span",Ve,p(t.userInitials),1)]),e("div",Ee,[e("p",Ne,p(t.userName||"Utilisateur"),1),e("p",Te,p(t.userEmail||"email@exemple.com"),1)]),(r(),n("svg",{class:V(["h-4 w-4 text-gray-400 group-hover:text-gray-600 transition-transform duration-200",{"rotate-180":t.showProfileMenu}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},o[20]||(o[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),v(B,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:C(()=>[t.showProfileMenu?(r(),n("div",Ue,[v(L,{to:"/settings?tab=compte",class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:g},{default:C(()=>o[21]||(o[21]=[e("svg",{class:"mr-3 h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1),M(" Mon profil ",-1)])),_:1,__:[21]}),o[23]||(o[23]=e("hr",{class:"my-1 border-gray-100"},null,-1)),e("button",{onClick:k,type:"button",class:"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors"},o[22]||(o[22]=[e("svg",{class:"mr-3 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),M(" Se déconnecter ",-1)]))])):y("",!0)]),_:1})],512)])])}}}),We=T(Re,[["__scopeId","data-v-7b1ff1d4"]]),Fe={class:"min-h-screen bg-gray-50"},Oe={class:"hidden lg:fixed lg:inset-y-0 lg:left-0 lg:z-50 lg:block lg:w-64 lg:bg-white lg:shadow-xl lg:border-r lg:border-gray-100"},qe={key:0,class:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl"},Ge={class:"lg:hidden sticky top-0 z-40 bg-white border-b border-gray-200 px-4 py-3"},Je={class:"flex items-center justify-between"},Qe={class:"sr-only"},Ke={key:0,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Xe={key:1,class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ye={class:"flex items-center space-x-2"},Ze={key:0,class:"flex items-center space-x-1 px-2 py-1 bg-green-50 border border-green-200 rounded-lg"},et={key:1,class:"flex items-center space-x-1 px-2 py-1 bg-blue-50 border border-blue-200 rounded-lg"},tt={key:2,class:"flex items-center space-x-1 px-2 py-1 bg-blue-50 border border-blue-200 rounded-lg"},ot={class:"text-xs font-medium text-blue-700"},st={key:3,class:"flex items-center space-x-1 px-2 py-1 bg-red-50 border border-red-200 rounded-lg"},lt={class:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 shadow-md"},rt={class:"text-xs font-semibold text-white"},nt={key:0,class:"absolute right-0 top-10 mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-100 py-2"},at={class:"px-4 py-3 border-b border-gray-100"},it={class:"text-sm font-medium text-gray-900"},ut={class:"text-xs text-gray-500"},dt=["disabled"],ct=["disabled"],pt={class:"lg:pl-64"},vt={class:"min-h-screen"},ft={key:1,class:"fixed inset-0 z-50 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center"},bt={class:"bg-white rounded-xl shadow-xl p-8 max-w-sm w-full mx-4"},mt={class:"text-center"},gt={class:"text-gray-600"},ht=N({__name:"default",setup(P){const d=Z(),m=oe(),h=ee(),i=w(!1),c=w(!1),f=w(!1),u=w(null),g=w(0),k=w(!1),a=w({plan:"free",isActive:!1,trialDaysLeft:7}),t=S(()=>d.userName||"Utilisateur"),o=S(()=>d.userEmail||"email@exemple.com"),b=S(()=>d.userInitials||"U"),L=async()=>{if(!(!d.userShopId||k.value))try{k.value=!0,console.log("🔄 [Layout] Chargement conversations non lues via API pour shop:",d.userShopId);const l=await h.conversations.list();if(l.success&&l.data){const s=l.data.filter($=>$.status==="new"||$.status==="active").length;g.value=s,console.log("✅ [Layout] Conversations non lues chargées via API:",s)}else console.error("❌ [Layout] Erreur API conversations:",l.error),g.value=0}catch(l){console.error("❌ [Layout] Erreur loading conversations via API:",l),g.value=0}finally{k.value=!1}},A=()=>{console.log("🔄 [Layout] Toggle mobile menu:",!i.value),i.value=!i.value,i.value&&(f.value=!1)},j=()=>{console.log("✅ [Layout] Fermeture mobile menu"),i.value=!1},U=()=>{console.log("🔄 [Layout] Toggle profile menu:",!c.value),c.value=!c.value},I=()=>{console.log("✅ [Layout] Fermeture profile menu"),c.value=!1},O=()=>{console.log("🔄 [Layout] Toggle mobile profile menu:",!f.value),f.value=!f.value},D=()=>{console.log("✅ [Layout] Fermeture mobile profile menu"),f.value=!1},z=async l=>{console.log(`🚀 [Layout] Initiation upgrade vers ${l}`),u.value=l,f.value=!1,c.value=!1;try{const s=await $fetch(`${m.public.apiBaseUrl}/api/v1/billing/create-checkout-session`,{method:"POST",headers:{Authorization:`Bearer ${d.token}`,"Content-Type":"application/json"},body:{plan:l,successUrl:`${window.location.origin}/billing?success=true&plan=${l}`,cancelUrl:`${window.location.origin}/billing?cancelled=true`}});if(console.log("💳 [Layout] Réponse API checkout:",s),s.success&&s.checkoutUrl)console.log("🔄 [Layout] Redirection vers Stripe Checkout:",s.checkoutUrl),window.location.href=s.checkoutUrl;else throw new Error(s.error||"Impossible de créer la session de paiement")}catch(s){console.error(`❌ [Layout] Erreur lors de l'upgrade vers ${l}:`,s),u.value=null,alert(s.message||`Erreur lors de l'upgrade vers ${l}`)}},R=async()=>{try{console.log("🔄 [Layout] Synchronisation subscription info depuis AuthStore...");const l=d.planDetails;a.value={plan:l.code,isActive:l.isActive,trialDaysLeft:l.trialDaysLeft},console.log("✅ [Layout] Subscription info synchronisée:",a.value)}catch(l){console.error("❌ [Layout] Erreur synchronisation subscription info:",l),a.value={plan:"free",isActive:!0,trialDaysLeft:5}}},H=async()=>{console.log("🚪 [Layout] Déconnexion en cours..."),c.value=!1,f.value=!1,j(),await d.logout(),await se("/login")},W=l=>{const s=l.target;f.value&&!s.closest(".relative")&&(f.value=!1)};_(i,()=>{i.value?document.body.style.overflow="hidden":document.body.style.overflow=""}),_(()=>d.isAuthenticated,async l=>{console.log("🔄 [Layout] Auth state changed:",l),l&&d.token?(await R(),await L()):(a.value={plan:"free",isActive:!1,trialDaysLeft:7},g.value=0)}),_(()=>d.planDetails,l=>{console.log("🔄 [Layout] Plan details changed in AuthStore:",l),a.value={plan:l.code,isActive:l.isActive,trialDaysLeft:l.trialDaysLeft}},{deep:!0}),_(()=>d.userShopId,async l=>{console.log("🔄 [Layout] Shop ID changed:",l),l?await L():g.value=0});const q=te();return _(()=>q.path,l=>{console.log("🔄 [Layout] Route changed:",l),j(),D(),I()}),Q(async()=>{console.log("🚀 [Layout] Montage du layout..."),document.addEventListener("click",W),d.isAuthenticated&&d.token&&(console.log("✅ [Layout] Utilisateur authentifié, chargement des données..."),await R(),await L());const l=le(async()=>{d.userShopId&&!k.value&&d.isAuthenticated&&await L()},3e4);K(()=>{console.log("🧹 [Layout] Nettoyage du layout..."),clearInterval(l),document.removeEventListener("click",W),document.body.style.overflow=""})}),(l,s)=>{const $=We,F=E;return r(),n("div",Fe,[e("div",Oe,[v($,{unreadCount:g.value,userName:t.value,userEmail:o.value,userInitials:b.value,showProfileMenu:c.value,userSubscriptionPlan:a.value.plan,userSubscriptionActive:a.value.isActive,trialDaysLeft:a.value.trialDaysLeft,onToggleProfile:U,onCloseProfile:I,onLogout:H,onUpgradeToPlan:z},null,8,["unreadCount","userName","userEmail","userInitials","showProfileMenu","userSubscriptionPlan","userSubscriptionActive","trialDaysLeft"])]),i.value?(r(),n("div",{key:0,class:"fixed inset-0 z-50 lg:hidden",onClick:j},[s[2]||(s[2]=e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm"},null,-1)),v(B,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"transform -translate-x-full","enter-to-class":"transform translate-x-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"transform translate-x-0","leave-to-class":"transform -translate-x-full"},{default:C(()=>[i.value?(r(),n("div",qe,[v($,{unreadCount:g.value,userName:t.value,userEmail:o.value,userInitials:b.value,showProfileMenu:c.value,userSubscriptionPlan:a.value.plan,userSubscriptionActive:a.value.isActive,trialDaysLeft:a.value.trialDaysLeft,isMobile:!0,onToggleProfile:U,onCloseProfile:I,onLogout:H,onCloseMobile:j,onUpgradeToPlan:z},null,8,["unreadCount","userName","userEmail","userInitials","showProfileMenu","userSubscriptionPlan","userSubscriptionActive","trialDaysLeft"])])):y("",!0)]),_:1})])):y("",!0),e("div",Ge,[e("div",Je,[e("button",{onClick:A,class:"inline-flex items-center justify-center p-2 rounded-xl text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200"},[e("span",Qe,p(i.value?"Fermer le menu":"Ouvrir le menu"),1),v(B,{"enter-active-class":"transition-all duration-200","enter-from-class":"rotate-180 opacity-0","enter-to-class":"rotate-0 opacity-100","leave-active-class":"transition-all duration-200","leave-from-class":"rotate-0 opacity-100","leave-to-class":"rotate-180 opacity-0",mode:"out-in"},{default:C(()=>[i.value?(r(),n("svg",Xe,s[4]||(s[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(r(),n("svg",Ke,s[3]||(s[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,-1)])))]),_:1})]),s[14]||(s[14]=e("div",{class:"flex items-center space-x-3"},[e("div",{class:"flex h-8 w-8 items-center justify-center rounded-xl bg-gradient-to-br from-blue-600 to-blue-700 shadow-lg"},[e("span",{class:"text-xs font-bold text-white"},"CS")]),e("span",{class:"text-lg font-bold text-gray-900"},"ChatSeller")],-1)),e("div",Ye,[a.value.plan==="pro"&&a.value.isActive?(r(),n("div",Ze,s[5]||(s[5]=[e("div",{class:"w-1.5 h-1.5 bg-green-500 rounded-full"},null,-1),e("span",{class:"text-xs font-medium text-green-700"},"Pro",-1)]))):a.value.plan==="starter"&&a.value.isActive?(r(),n("div",et,s[6]||(s[6]=[e("div",{class:"w-1.5 h-1.5 bg-blue-500 rounded-full"},null,-1),e("span",{class:"text-xs font-medium text-blue-700"},"Starter",-1)]))):a.value.plan==="free"&&a.value.isActive&&a.value.trialDaysLeft>0?(r(),n("div",tt,[s[7]||(s[7]=e("div",{class:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"},null,-1)),e("span",ot,p(a.value.trialDaysLeft)+"j",1)])):a.value.plan==="free"&&(!a.value.isActive||a.value.trialDaysLeft===0)?(r(),n("div",st,s[8]||(s[8]=[e("div",{class:"w-1.5 h-1.5 bg-red-500 rounded-full"},null,-1),e("span",{class:"text-xs font-medium text-red-700"},"Expiré",-1)]))):y("",!0),e("button",{onClick:O,class:"relative"},[e("div",lt,[e("span",rt,p(b.value),1)]),v(B,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:C(()=>[f.value?(r(),n("div",nt,[e("div",at,[e("p",it,p(t.value||"Utilisateur"),1),e("p",ut,p(o.value||"email@exemple.com"),1)]),v(F,{to:"/settings?tab=compte",class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:D},{default:C(()=>s[9]||(s[9]=[e("svg",{class:"mr-3 h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1),M(" Mon profil ",-1)])),_:1,__:[9]}),v(F,{to:"/billing",class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:D},{default:C(()=>s[10]||(s[10]=[e("svg",{class:"mr-3 h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})],-1),M(" Facturation ",-1)])),_:1,__:[10]}),a.value.plan==="free"?(r(),n("button",{key:0,onClick:s[0]||(s[0]=G=>z("starter")),disabled:u.value==="starter",class:"w-full flex items-center px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 transition-colors disabled:opacity-50"},[s[11]||(s[11]=e("svg",{class:"mr-3 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)),M(" "+p(u.value==="starter"?"Redirection...":a.value.trialDaysLeft>0?"Passer à Starter":"Réactiver (Starter)"),1)],8,dt)):a.value.plan==="starter"&&a.value.isActive?(r(),n("button",{key:1,onClick:s[1]||(s[1]=G=>z("pro")),disabled:u.value==="pro",class:"w-full flex items-center px-4 py-2 text-sm text-purple-600 hover:bg-purple-50 transition-colors disabled:opacity-50"},[s[12]||(s[12]=e("svg",{class:"mr-3 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})],-1)),M(" "+p(u.value==="pro"?"Redirection...":"Passer au Pro"),1)],8,ct)):y("",!0),e("button",{onClick:H,class:"w-full flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors"},s[13]||(s[13]=[e("svg",{class:"mr-3 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),M(" Se déconnecter ",-1)]))])):y("",!0)]),_:1})])])])]),e("div",pt,[e("main",vt,[X(l.$slots,"default",{},void 0)])]),u.value?(r(),n("div",ft,[e("div",bt,[e("div",mt,[s[15]||(s[15]=Y('<div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4" data-v-b378fda0><svg class="animate-spin w-8 h-8 text-blue-600" fill="none" viewBox="0 0 24 24" data-v-b378fda0><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" data-v-b378fda0></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" data-v-b378fda0></path></svg></div><h3 class="text-lg font-semibold text-gray-900 mb-2" data-v-b378fda0>Redirection vers Stripe</h3>',2)),e("p",gt,"Préparation de votre session de paiement "+p(u.value)+"...",1)])])])):y("",!0)])}}}),At=T(ht,[["__scopeId","data-v-b378fda0"]]);export{At as default};
