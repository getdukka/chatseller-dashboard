import{i as o,a as t,n as s,j as a}from"./BIGBsnYa.js";import"./Dp9Ai0YM.js";import"./bq2zsT37.js";const l=o(async(i,n)=>{try{const e=t();if(!e.isLoggedIn)return s("/login");const r=e.user;if(!r||r.role!=="admin")throw console.log("⛔ Middleware admin: Accès refusé - role insuffisant"),a({statusCode:403,statusMessage:"Accès refusé - Permissions insuffisantes"});console.log("✅ Middleware admin: Accès autorisé")}catch(e){return console.error("❌ Middleware admin: Erreur:",e),s("/")}});export{l as default};
