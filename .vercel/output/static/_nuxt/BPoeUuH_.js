import{i as l,a as u,n as o,j as n}from"./BIGBsnYa.js";import"./Dp9Ai0YM.js";import"./bq2zsT37.js";const m=l(async(a,c)=>{try{const e=u();if(!e.isLoggedIn)return o("/login");const s=e.user;if(!s)return o("/login");const r=a.meta.requiresRole;if(r){const t=Array.isArray(r)?r:[r],i=s.role||"user";if(!t.includes(i))throw console.log(`⛔ Middleware role: Accès refusé - rôle requis: ${t.join(", ")}, rôle utilisateur: ${i}`),n({statusCode:403,statusMessage:"Accès refusé - Rôle insuffisant"})}console.log("✅ Middleware role: Accès autorisé")}catch(e){return console.error("❌ Middleware role: Erreur:",e),o("/")}});export{m as default};
