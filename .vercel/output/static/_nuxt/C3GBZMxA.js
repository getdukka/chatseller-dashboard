import{_ as I}from"./BGAeSPyx.js";import{e as U,a as C,u as N,b as T,n as E,d as L}from"./BIGBsnYa.js";import{s as V}from"./x_rD_Ya3.js";import{l as B,d as x,m as O,I as R,J as D,E as i,H as t,a0 as n,U as o,u as e,M as p,Q as f,O as k,N as w,G as d}from"./Dp9Ai0YM.js";import{_ as P}from"./DlAUqK2U.js";import"./bq2zsT37.js";const q={class:"min-h-screen bg-gray-50 py-8"},H={class:"max-w-4xl mx-auto px-4"},J={class:"bg-white rounded-lg shadow-lg p-6"},M={class:"mb-6 p-4 bg-blue-50 rounded-lg"},Q={class:"space-y-2 text-sm"},z={class:"bg-blue-100 px-2 py-1 rounded"},G={class:"bg-blue-100 px-2 py-1 rounded"},j={class:"bg-blue-100 px-2 py-1 rounded"},F={class:"bg-blue-100 px-2 py-1 rounded"},K={class:"mb-6 p-4 bg-green-50 rounded-lg"},W={class:"space-y-2 text-sm"},X={key:0},Y={key:1},Z={key:2,class:"text-red-600"},$={class:"mb-6 p-4 bg-yellow-50 rounded-lg"},ss={class:"space-y-2 text-sm"},ts={key:0},es={key:1},os={key:2},ns={class:"mb-6 p-4 bg-purple-50 rounded-lg"},ls=["disabled"],rs={key:0,class:"space-y-2 text-sm"},us={key:0,class:"text-red-600"},as={key:1},is={class:"bg-purple-100 p-3 rounded mt-2 overflow-x-auto text-xs"},ds={class:"mb-6 p-4 bg-indigo-50 rounded-lg"},ps={class:"space-y-2 text-sm"},gs={class:"bg-indigo-100 px-2 py-1 rounded"},bs={class:"bg-indigo-100 px-2 py-1 rounded"},ms={class:"bg-indigo-100 px-2 py-1 rounded"},xs={class:"p-4 bg-gray-50 rounded-lg"},fs={class:"flex flex-wrap gap-3"},ys=B({__name:"debug-auth",setup(cs){const v=U(),g=C(),b=L(),y=x(!1),a=x(null),m=x({full:"",path:"",hash:"",query:""}),l=x({isLoggedIn:!1,hasValidSession:!1,user:null,error:null}),r=x({isAuthenticated:!1,hasToken:!1,user:null});O(()=>({supabaseUrl:b.public.supabase?.url||"Non configuré",apiBaseUrl:b.public.apiBaseUrl||"Non configuré",environment:"Production"}));const h=async()=>{m.value={full:window.location.href,path:window.location.pathname,hash:window.location.hash,query:window.location.search};try{const{data:{user:u},error:s}=await v.auth.getUser(),{data:{session:c}}=await v.auth.getSession();l.value={isLoggedIn:!!u,hasValidSession:!!c,user:u,error:s?.message||null}}catch(u){l.value.error=u.message}r.value={isAuthenticated:g.isAuthenticated,hasToken:!!g.token,user:g.user}},A=async()=>{y.value=!0,a.value=null;try{if(!g.user?.id||!g.token)throw new Error("Pas d'utilisateur ou de token dans le store");const s=await T().shops.get(g.user.id);a.value={success:s.success,data:s.data,error:s.error}}catch(u){a.value={success:!1,error:u.message}}finally{y.value=!1}},S=async()=>{await g.restoreSession(),await h()},_=()=>{E("/auth/callback#access_token=fake_token&refresh_token=fake_refresh&type=signup")};return R(async()=>{await h();const u=V(h,2e3);D(()=>{clearInterval(u)})}),N({title:"Debug Auth - ChatSeller"}),(u,s)=>{const c=I;return d(),i("div",q,[t("div",H,[t("div",J,[s[35]||(s[35]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-6"},"🔍 Debug Tool - Authentification ChatSeller",-1)),t("div",M,[s[8]||(s[8]=t("h2",{class:"text-lg font-semibold text-blue-900 mb-3"},"📍 Informations URL",-1)),t("div",Q,[t("p",null,[s[0]||(s[0]=t("strong",null,"URL complète:",-1)),s[1]||(s[1]=n()),t("code",z,o(e(m).full),1)]),t("p",null,[s[2]||(s[2]=t("strong",null,"Path:",-1)),s[3]||(s[3]=n()),t("code",G,o(e(m).path),1)]),t("p",null,[s[4]||(s[4]=t("strong",null,"Hash:",-1)),s[5]||(s[5]=n()),t("code",j,o(e(m).hash||"Aucun"),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"Query:",-1)),s[7]||(s[7]=n()),t("code",F,o(e(m).query||"Aucun"),1)])])]),t("div",K,[s[14]||(s[14]=t("h2",{class:"text-lg font-semibold text-green-900 mb-3"},"🔐 État Supabase Auth",-1)),t("div",W,[t("p",null,[s[9]||(s[9]=t("strong",null,"Utilisateur connecté:",-1)),t("span",{class:f(e(l).isLoggedIn?"text-green-600":"text-red-600")},o(e(l).isLoggedIn?"Oui":"Non"),3)]),e(l).user?(d(),i("p",X,[s[10]||(s[10]=t("strong",null,"Email:",-1)),n(" "+o(e(l).user.email),1)])):p("",!0),e(l).user?(d(),i("p",Y,[s[11]||(s[11]=t("strong",null,"ID:",-1)),n(" "+o(e(l).user.id),1)])):p("",!0),t("p",null,[s[12]||(s[12]=t("strong",null,"Session valide:",-1)),t("span",{class:f(e(l).hasValidSession?"text-green-600":"text-red-600")},o(e(l).hasValidSession?"Oui":"Non"),3)]),e(l).error?(d(),i("p",Z,[s[13]||(s[13]=t("strong",null,"Erreur:",-1)),n(" "+o(e(l).error),1)])):p("",!0)])]),t("div",$,[s[20]||(s[20]=t("h2",{class:"text-lg font-semibold text-yellow-900 mb-3"},"📦 État Store Auth",-1)),t("div",ss,[t("p",null,[s[15]||(s[15]=t("strong",null,"Authentifié:",-1)),t("span",{class:f(e(r).isAuthenticated?"text-green-600":"text-red-600")},o(e(r).isAuthenticated?"Oui":"Non"),3)]),e(r).user?(d(),i("p",ts,[s[16]||(s[16]=t("strong",null,"Email:",-1)),n(" "+o(e(r).user.email),1)])):p("",!0),e(r).user?(d(),i("p",es,[s[17]||(s[17]=t("strong",null,"Nom:",-1)),n(" "+o(e(r).user.name),1)])):p("",!0),e(r).user?(d(),i("p",os,[s[18]||(s[18]=t("strong",null,"Shop ID:",-1)),n(" "+o(e(r).user.shopId),1)])):p("",!0),t("p",null,[s[19]||(s[19]=t("strong",null,"Token présent:",-1)),t("span",{class:f(e(r).hasToken?"text-green-600":"text-red-600")},o(e(r).hasToken?"Oui":"Non"),3)])])]),t("div",ns,[s[24]||(s[24]=t("h2",{class:"text-lg font-semibold text-purple-900 mb-3"},"🌐 Test API",-1)),t("button",{onClick:A,disabled:e(y),class:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 mb-4"},o(e(y)?"Test en cours...":"Tester la récupération des données"),9,ls),e(a)?(d(),i("div",rs,[t("p",null,[s[21]||(s[21]=t("strong",null,"Statut:",-1)),t("span",{class:f(e(a).success?"text-green-600":"text-red-600")},o(e(a).success?"Succès":"Erreur"),3)]),e(a).error?(d(),i("p",us,[s[22]||(s[22]=t("strong",null,"Erreur:",-1)),n(" "+o(e(a).error),1)])):p("",!0),e(a).data?(d(),i("div",as,[s[23]||(s[23]=t("p",null,[t("strong",null,"Données reçues:")],-1)),t("pre",is,o(JSON.stringify(e(a).data,null,2)),1)])):p("",!0)])):p("",!0)]),t("div",ds,[s[31]||(s[31]=t("h2",{class:"text-lg font-semibold text-indigo-900 mb-3"},"⚙️ Configuration détectée",-1)),t("div",ps,[t("p",null,[s[25]||(s[25]=t("strong",null,"Supabase URL:",-1)),s[26]||(s[26]=n()),t("code",gs,o(e(b).supabaseUrl),1)]),t("p",null,[s[27]||(s[27]=t("strong",null,"API Base URL:",-1)),s[28]||(s[28]=n()),t("code",bs,o(e(b).apiBaseUrl),1)]),t("p",null,[s[29]||(s[29]=t("strong",null,"Environnement:",-1)),s[30]||(s[30]=n()),t("code",ms,o(e(b).environment),1)])])]),t("div",xs,[s[34]||(s[34]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-3"},"🛠️ Actions de test",-1)),t("div",fs,[t("button",{onClick:S,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"}," Rafraîchir Auth "),t("button",{onClick:_,class:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"}," Simuler Callback "),k(c,{to:"/auth/callback",class:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700"},{default:w(()=>[...s[32]||(s[32]=[n(" Aller au Callback ",-1)])]),_:1}),k(c,{to:"/onboarding",class:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700"},{default:w(()=>[...s[33]||(s[33]=[n(" Aller à Onboarding ",-1)])]),_:1})])])])])])}}}),_s=P(ys,[["__scopeId","data-v-8610f9b6"]]);export{_s as default};
