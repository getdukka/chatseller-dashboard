import{l as q,d as u,m as P,I as Q,E as n,H as e,M as d,a0 as z,Q as L,U as l,a2 as N,a3 as X,a6 as Y,W,F as J,P as K,G as r}from"./DQgDrh1u.js";import{a as Z,b as ee,u as te}from"./Cm96zG12.js";import{_ as se}from"./DlAUqK2U.js";import"./DAvq3nrc.js";const oe={class:"min-h-screen bg-gray-50"},le={class:"bg-white shadow-sm border-b border-gray-200"},ae={class:"px-8 py-6"},ne={class:"flex items-center justify-between"},re={class:"flex items-center space-x-4"},ie=["disabled"],de=["disabled"],ce={class:"p-8"},ue={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},me={class:"card-modern"},ve={class:"flex items-center"},pe={class:"ml-4"},xe={class:"text-2xl font-bold text-gray-900"},ge={class:"card-modern"},he={class:"flex items-center"},_e={class:"ml-4"},ye={class:"text-2xl font-bold text-gray-900"},fe={class:"text-xs text-green-600 mt-1"},be={class:"card-modern"},we={class:"flex items-center"},ke={class:"ml-4"},Ce={class:"text-2xl font-bold text-gray-900"},Me={class:"card-modern"},Ee={class:"flex items-center"},Ae={class:"ml-4"},Le={class:"text-2xl font-bold text-gray-900"},Ve={class:"card-modern mb-6"},De={class:"p-6"},je={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0"},Oe={class:"flex-1 max-w-lg"},Be={class:"relative"},Se={class:"flex flex-wrap items-center space-x-4"},Fe={class:"card-modern"},Pe={class:"px-6 py-4 border-b border-gray-200"},ze={class:"flex items-center justify-between"},Ne={class:"text-sm text-gray-500"},Re={key:0,class:"p-12"},Ie={key:1,class:"p-12 text-center"},Te={class:"text-gray-500 mb-4"},Ue={key:2,class:"overflow-x-auto"},He={class:"min-w-full divide-y divide-gray-200"},$e={class:"bg-white divide-y divide-gray-200"},Ge={class:"table-cell"},qe={class:"text-sm font-medium text-gray-900"},Qe={key:0,class:"text-xs text-gray-500"},Xe={class:"table-cell"},Ye={class:"text-sm font-medium text-gray-900"},We={key:0,class:"text-sm text-gray-500"},Je={key:1,class:"text-sm text-gray-500"},Ke={class:"table-cell"},Ze={class:"text-sm text-gray-900"},et={class:"text-sm text-gray-500"},tt={key:0,class:"text-xs text-green-600 mt-1"},st={class:"table-cell"},ot={class:"text-sm font-medium text-gray-900"},lt={key:0,class:"text-xs text-green-600"},at={class:"table-cell"},nt={class:"text-sm text-gray-900"},rt={class:"table-cell"},it={class:"table-cell"},dt={class:"text-sm text-gray-900"},ct={key:0,class:"text-xs text-green-600"},ut={class:"table-cell text-right"},mt={class:"flex items-center justify-end space-x-2"},vt=["onClick"],pt={key:3,class:"text-center py-12"},xt={class:"mt-2 text-gray-500"},gt={key:0,class:"mt-4"},ht={key:0,class:"fixed bottom-4 right-4 max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden z-50"},_t={class:"p-4"},yt={class:"flex items-start"},ft={class:"flex-shrink-0"},bt={key:0,class:"h-6 w-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},wt={key:1,class:"h-6 w-6 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},kt={class:"ml-3 w-0 flex-1 pt-0.5"},Ct={class:"text-sm font-medium text-gray-900"},Mt={class:"ml-4 flex-shrink-0 flex"},Et=q({__name:"orders",setup(At){Z();const V=ee(),m=u(!0),h=u(!1),c=u(""),b=u(null),v=u({status:""}),w=u([]),p=u({totalOrders:0,totalRevenue:0,averageOrderValue:0,pendingOrders:0,revenueGrowth:0}),x=u({show:!1,message:"",type:"success"}),_=P(()=>{let s=w.value;if(c.value){const t=c.value.toLowerCase();s=s.filter(o=>o.customer_name?.toLowerCase().includes(t)||o.customer_email?.toLowerCase().includes(t)||o.id.toLowerCase().includes(t)||o.external_order_id?.toLowerCase().includes(t))}return v.value.status&&(s=s.filter(t=>t.status===v.value.status)),s.sort((t,o)=>new Date(o.created_at).getTime()-new Date(t.created_at).getTime())}),M=P(()=>v.value.status!==""||c.value!==""),D=s=>!s.product_items||!Array.isArray(s.product_items)?0:s.product_items.reduce((t,o)=>t+(o.quantity||1),0),j=s=>!s.upsell_items||!Array.isArray(s.upsell_items)?0:s.upsell_items.reduce((t,o)=>t+(o.quantity||1),0),R=s=>s.upsell_items&&Array.isArray(s.upsell_items)&&s.upsell_items.length>0,O=s=>{if(!s.product_items||!Array.isArray(s.product_items)||s.product_items.length===0)return"Aucun produit";const t=s.product_items[0],o=t.name||t.productName||"Produit";return s.product_items.length===1?o:`${o} et ${s.product_items.length-1} autre(s)`},E=s=>(s.total_amount||0)+(s.upsell_amount||0),k=(s,t="EUR")=>t==="XOF"?new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF",minimumFractionDigits:0}).format(s):new Intl.NumberFormat("fr-FR",{style:"currency",currency:t||"EUR"}).format(s),C=s=>new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),B=s=>({pending:"En attente",confirmed:"Confirm√©e",shipped:"Exp√©di√©e",delivered:"Livr√©e",cancelled:"Annul√©e"})[s]||s,I=s=>({pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",S=s=>s?{card:"Carte bancaire",paypal:"PayPal",bank_transfer:"Virement",cash:"Esp√®ces",mobile_money:"Mobile Money"}[s]||s:"Non sp√©cifi√©",y=(s,t="success")=>{x.value={show:!0,message:s,type:t},setTimeout(()=>{x.value.show=!1},5e3)},A=async()=>{m.value=!0,b.value=null;try{console.log("üîÑ Chargement commandes via API...");const s=await V.orders.list();if(s.success&&s.data)w.value=s.data,console.log("‚úÖ Commandes charg√©es:",w.value.length),await T();else throw new Error(s.error||"Erreur lors du chargement des commandes")}catch(s){console.error("‚ùå Erreur chargement commandes:",s),b.value=s.message||"Erreur lors du chargement des commandes"}finally{m.value=!1}},T=async()=>{try{const s=w.value,t=new Date,o=s.filter(i=>{const g=new Date(i.created_at);return g.getMonth()===t.getMonth()&&g.getFullYear()===t.getFullYear()}),f=o.reduce((i,g)=>i+E(g),0);p.value={totalOrders:o.length,totalRevenue:f,averageOrderValue:o.length>0?f/o.length:0,pendingOrders:s.filter(i=>i.status==="pending").length,revenueGrowth:23.5}}catch(s){console.warn("‚ö†Ô∏è Erreur chargement stats:",s)}},U=async()=>{await A(),y("Commandes actualis√©es avec succ√®s!")},H=async()=>{h.value=!0;try{const s=["ID Commande","ID Externe","Nom Client","Email Client","T√©l√©phone","Adresse","Produits","Quantit√© Totale","Montant Total","Montant Upsell","Devise","M√©thode Paiement","Statut","Date Cr√©ation","Date Export","Notes"],t=_.value.map(a=>[`#${a.id.slice(-8).toUpperCase()}`,a.external_order_id||"",a.customer_name||"",a.customer_email||"",a.customer_phone||"",a.customer_address||"",O(a),D(a)+j(a),E(a),a.upsell_amount||0,a.currency,S(a.payment_method),B(a.status),C(a.created_at),a.exported_at?C(a.exported_at):"",a.notes||""]),o=[s.join(","),...t.map(a=>a.map(G=>`"${G}"`).join(","))].join(`
`),f=new Blob([o],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),g=URL.createObjectURL(f);i.setAttribute("href",g),i.setAttribute("download",`commandes-chatseller-${new Date().toISOString().split("T")[0]}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),y(`${_.value.length} commande(s) export√©e(s) avec succ√®s!`)}catch(s){console.error("Erreur lors de l'export CSV:",s),y("Erreur lors de l'export CSV","error")}finally{h.value=!1}},$=async s=>{try{const t=await V.orders.get(s.id);t.success?console.log("Commande d√©taill√©e:",t.data):y("Erreur lors du chargement des d√©tails","error")}catch(t){console.error("Erreur vue commande:",t),y("Erreur lors du chargement des d√©tails","error")}},F=()=>{c.value="",v.value.status=""};return Q(()=>{A()}),te({title:"Commandes - ChatSeller Dashboard"}),(s,t)=>(r(),n("div",oe,[e("div",le,[e("div",ae,[e("div",ne,[t[5]||(t[5]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Commandes"),e("p",{class:"mt-2 text-gray-600"}," G√©rez toutes les commandes g√©n√©r√©es par votre agent IA ")],-1)),e("div",re,[e("button",{onClick:H,disabled:h.value,class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 transition-colors"},[(r(),n("svg",{class:L(["w-4 h-4 mr-2",{"animate-spin":h.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[3]||(t[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)]),2)),z(" "+l(h.value?"Export en cours...":"Exporter CSV"),1)],8,ie),e("button",{onClick:U,disabled:m.value,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors"},[(r(),n("svg",{class:L(["w-4 h-4 mr-2",{"animate-spin":m.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},t[4]||(t[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),z(" "+l(m.value?"Actualisation...":"Actualiser"),1)],8,de)])])])]),e("div",ce,[e("div",ue,[e("div",me,[e("div",ve,[t[8]||(t[8]=e("div",{class:"p-3 bg-blue-100 rounded-xl"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),e("div",pe,[t[6]||(t[6]=e("p",{class:"text-sm font-medium text-gray-600"},"Total commandes",-1)),e("p",xe,l(p.value.totalOrders),1),t[7]||(t[7]=e("p",{class:"text-xs text-gray-500 mt-1"},"Ce mois-ci",-1))])])]),e("div",ge,[e("div",he,[t[10]||(t[10]=e("div",{class:"p-3 bg-green-100 rounded-xl"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("div",_e,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Revenus totaux",-1)),e("p",ye,l(k(p.value.totalRevenue)),1),e("p",fe,"+"+l(p.value.revenueGrowth)+"% vs mois dernier",1)])])]),e("div",be,[e("div",we,[t[13]||(t[13]=e("div",{class:"p-3 bg-yellow-100 rounded-xl"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})])],-1)),e("div",ke,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Panier moyen",-1)),e("p",Ce,l(k(p.value.averageOrderValue)),1),t[12]||(t[12]=e("p",{class:"text-xs text-gray-500 mt-1"},"Par commande",-1))])])]),e("div",Me,[e("div",Ee,[t[16]||(t[16]=e("div",{class:"p-3 bg-orange-100 rounded-xl"},[e("svg",{class:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Ae,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-600"},"En attente",-1)),e("p",Le,l(p.value.pendingOrders),1),t[15]||(t[15]=e("p",{class:"text-xs text-orange-600 mt-1"},"N√©cessitent une action",-1))])])])]),e("div",Ve,[e("div",De,[e("div",je,[e("div",Oe,[e("div",Be,[t[17]||(t[17]=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),N(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"text",placeholder:"Rechercher une commande...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"},null,512),[[X,c.value]])])]),e("div",Se,[N(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>v.value.status=o),class:"input-modern"},t[18]||(t[18]=[W('<option value="" data-v-c50c5707>Tous les statuts</option><option value="pending" data-v-c50c5707>En attente</option><option value="confirmed" data-v-c50c5707>Confirm√©e</option><option value="shipped" data-v-c50c5707>Exp√©di√©e</option><option value="delivered" data-v-c50c5707>Livr√©e</option><option value="cancelled" data-v-c50c5707>Annul√©e</option>',6)]),512),[[Y,v.value.status]]),M.value?(r(),n("button",{key:0,onClick:F,class:"text-sm text-gray-500 hover:text-gray-700 underline"}," Effacer les filtres ")):d("",!0)])])])]),e("div",Fe,[e("div",Pe,[e("div",ze,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900"}," Liste des commandes ",-1)),e("span",Ne,l(_.value.length)+" commande(s) ",1)])]),m.value?(r(),n("div",Re,t[20]||(t[20]=[e("div",{class:"flex items-center justify-center"},[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e("span",{class:"ml-3 text-gray-600"},"Chargement des commandes...")],-1)]))):b.value?(r(),n("div",Ie,[t[21]||(t[21]=e("div",{class:"text-red-600 mb-4"},[e("svg",{class:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.232 15.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t[22]||(t[22]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Erreur de chargement",-1)),e("p",Te,l(b.value),1),e("button",{onClick:A,class:"btn-primary"}," R√©essayer ")])):_.value.length>0?(r(),n("div",Ue,[e("table",He,[t[23]||(t[23]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"table-header"},"Commande"),e("th",{class:"table-header"},"Client"),e("th",{class:"table-header"},"Produits"),e("th",{class:"table-header"},"Montant"),e("th",{class:"table-header"},"Paiement"),e("th",{class:"table-header"},"Statut"),e("th",{class:"table-header"},"Date"),e("th",{class:"table-header text-right"},"Actions")])],-1)),e("tbody",$e,[(r(!0),n(J,null,K(_.value,o=>(r(),n("tr",{key:o.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Ge,[e("div",qe," #"+l(o.id.slice(-8).toUpperCase()),1),o.external_order_id?(r(),n("div",Qe," Ext: "+l(o.external_order_id),1)):d("",!0)]),e("td",Xe,[e("div",null,[e("div",Ye,l(o.customer_name||"Client anonyme"),1),o.customer_email?(r(),n("div",We,l(o.customer_email),1)):d("",!0),o.customer_phone?(r(),n("div",Je,l(o.customer_phone),1)):d("",!0)])]),e("td",Ke,[e("div",Ze,l(D(o))+" article(s) ",1),e("div",et,l(O(o)),1),R(o)?(r(),n("div",tt," + "+l(j(o))+" upsell(s) ",1)):d("",!0)]),e("td",st,[e("div",ot,l(k(E(o),o.currency)),1),o.upsell_amount&&o.upsell_amount>0?(r(),n("div",lt," + "+l(k(o.upsell_amount,o.currency))+" upsell ",1)):d("",!0)]),e("td",at,[e("div",nt,l(S(o.payment_method)),1)]),e("td",rt,[e("span",{class:L([I(o.status),"status-badge"])},l(B(o.status)),3)]),e("td",it,[e("div",dt,l(C(o.created_at)),1),o.exported_at?(r(),n("div",ct," Export√©e "+l(C(o.exported_at)),1)):d("",!0)]),e("td",ut,[e("div",mt,[e("button",{onClick:f=>$(o),class:"action-button-primary",title:"Voir les d√©tails"}," Voir ",8,vt)])])]))),128))])])])):(r(),n("div",pt,[t[24]||(t[24]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 48 48"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1)),t[25]||(t[25]=e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Aucune commande trouv√©e",-1)),e("p",xt,l(c.value||M.value?"Aucune commande ne correspond √† vos crit√®res":"Les commandes g√©n√©r√©es par votre Vendeur IA appara√Ætront ici"),1),c.value||M.value?(r(),n("div",gt,[e("button",{onClick:F,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-blue-600 bg-blue-100 hover:bg-blue-200 transition-colors"}," Effacer les filtres ")])):d("",!0)]))])]),x.value.show?(r(),n("div",ht,[e("div",_t,[e("div",yt,[e("div",ft,[x.value.type==="success"?(r(),n("svg",bt,t[26]||(t[26]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))):(r(),n("svg",wt,t[27]||(t[27]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.232 15.5c-.77.833.192 2.5 1.732 2.5z"},null,-1)])))]),e("div",kt,[e("p",Ct,l(x.value.message),1)]),e("div",Mt,[e("button",{onClick:t[2]||(t[2]=o=>x.value.show=!1),class:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500"},t[28]||(t[28]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])])])):d("",!0)]))}}),Ot=se(Et,[["__scopeId","data-v-c50c5707"]]);export{Ot as default};
